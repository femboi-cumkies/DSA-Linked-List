#include <stdio.h>
#include <ctype.h>
#include <malloc.h>
#include <stdlib.h>

typedef struct Node {
	int data;
	struct Node* next;
}Node;

//FUNCTION TO CREATE A LIST
void CREATE (Node **START)
{
	Node *NewNode = (Node*)malloc(sizeof(Node));
	char resp;
	int ctr=1;
	
	*START=NewNode;
	printf("\n\nCreating a Single Linked List!!!\n\n");
	do
	{
		printf("Node No. %d\n", ctr);
		printf("Enter Data => ");
		scanf("%d", &NewNode->data);
		getchar();
		printf("\nAdd another Node [Y/N]: ");
		resp = getchar();
		if (toupper(resp) == 'Y')
		{
			ctr++;
			NewNode->next = (Node*)malloc(sizeof(Node));
			NewNode=NewNode->next;
		}
	} while (toupper(resp) == 'Y');
	NewNode->next=NULL;
	NewNode=NULL;
	getchar();
	printf("LIST CREATED!\a\nPRESS ANY KEY TO CONTINUE...");
	getchar();
}

//FUNCTION TO TRAVERSE THE LIST
void TRAVERSE(Node* START)
{
	Node* Current=START;
	int ctr=1;
	
	printf("\n\n\t<< UPDATED LIST >>\n\n\a");
	if (Current==NULL) {
		printf("The Single Linked List is EMPTY!!!\a\n");
		return;
	}
	else while (Current!=NULL)
	{
		printf("Node %d Content: \n", ctr);
		printf("\tData => %d\n", Current->data);
		Current=Current->next;
		ctr++;
	}
	
	Current=NULL;
	printf("PRESS ANY KEY TO CONTINUE...");
	getchar();
}

//FUNCTION THAT INSERTS A NODE AT THE START
void INSERT_START(Node **START, int value)
{
	Node *NewNode=(Node*)malloc(sizeof(Node));
	if (NewNode==NULL)
	{
		printf("Memory Allocation FAILED!\n\a");
		printf("PRESS ANY KEY TO CONTINUE...");
		getchar();
		return;
	}
	
//ATTACHING NEW NODE AT START
	NewNode->data=value;
	NewNode->next=*START;
	*START=NewNode;
	printf("NEW NODE ADDED!\a\nPRESS ANY KEY TO CONTINUE...");
	getchar();
}

//FUNCTION THAT INSERTS A NODE AT THE END
void INSERT_END(Node **START, int value)
{
	Node *NewNode = (Node*)malloc(sizeof(Node));
	Node *END = *START;
	
	NewNode->data = value;
	NewNode->next = NULL;
	
	if (*START == NULL) {
		*START = NewNode;
		return;
	}
	
//FINDING THE END OF THE LINKED LIST
	while(END->next != NULL)
	{
		END = END->next;		
	}
	
//ATTACHING NEW NODE AT END
	END->next = NewNode;
	NewNode=END=NULL;
	printf("NEW NODE ADDED!\a\nPRESS ANY KEY TO CONTINUE...");
	getchar();
}

//FUNCTION THAT INSERTS A NODE BEFORE A VALUE
void INSERT_BEFORE (Node **START, int before, int value)
{
	Node *NewNode, *Previous, *Current;
	int Flag=0;
	
	NewNode=(Node*)malloc(sizeof(Node));
	NewNode->data=value;
	NewNode->next=NULL;
	
//FINDING VALUE
	Previous=NULL;
	Current=*START;
	while (Flag!=1 && Current!=NULL){
		if (before==Current->data)
			Flag=1;
		else{
			Previous=Current;
			Current=Current->next;
		}
	} 
	
//INSERTING BEFORE VALUE
	if (Flag==1)
	{
		NewNode->next=Current;
		if (Previous==NULL)
			*START=NewNode;
		else
			Previous->next=NewNode;
		NewNode=NULL;
	} else {
		printf("The Value where you want to insert the New Node does not exist!\a\nPRESS ANY KEY TO CONTINUE...");
		getchar();
		return;
	}
	printf("NODE %d ADDED BEFORE NODE %d.\a\nPRESS ANY KEY TO CONTINUE...", value, before);
	getchar();
	Previous=Current=NULL;
}

//FUNCTION THAT INSERTS A NODE AFTER A VALUE
void INSERT_AFTER(Node **START, int after, int value)
{
	Node *NewNode, *Previous=NULL, *Current=*START;
	int Flag = 0;
	
	NewNode=(Node*)malloc(sizeof(Node));
	NewNode->data=value;
	NewNode->next=NULL;
	
//FINDING VALUE
	while (Flag!=1 && Current!=NULL) 
	{
		if (after==Current->data)
			Flag=1;
		else
			Current=Current->next;
	}
	
//INSERTING AFTER VALUE
	if (Flag==1) {
		NewNode->next=Current->next;
		Current->next=NewNode;
		NewNode=NULL;
	} else {
		printf("The Value where you want to insert the New Node does not exist!\a\nPRESS ANY KEY TO CONTINUE...");
		getchar();
	}
	
	printf("NODE %d ADDED AFTER NODE %d. \a\nPRESS ANY KEY TO CONTINUE...", value, after);
	getchar();
	
}

//FUNCTION THAT DELETES NODE AT THE START
void DELETE_START(Node **START)
{
	Node *DelNode = *START, *Previous;
	*START=(*START)->next;
	DelNode->next=NULL;
	DelNode=NULL;
	printf("START NODE DELETED!\a\nPRESS ANY KEY TO CONTINUE...");
	getchar();
}

//FUNCTION THAT DELETES NODE AT THE END
void DELETE_END(Node **START)
{
	Node *DelNode=*START;
	Node *Previous=DelNode;
	
//FINDING END NODE
	while(DelNode->next!=NULL) {
		Previous = DelNode;
		DelNode = DelNode->next;
	}
	Previous->next=NULL;
	Previous=DelNode=NULL;
	printf("END NODE DELETED!\a\nPRESS ANY KEY TO CONTINUE...");
	getchar();
}

//FUNCTION THAT DELETES NODE BY VALUE
void DELETE_VALUE(Node **START, int value)
{
	Node *Previous=NULL, *DelNode=*START;
	int Flag=0;
	
//FINDING VALUE
	while (Flag!=1 && DelNode!=NULL)
	{
		if(value==DelNode->data)
			Flag=1;
		else {
			Previous=DelNode;
			DelNode=DelNode->next;
		}
	}
	
//DELETING VALUE
	if (Flag==0) {
		printf("Value to be deleted NOT FOUND!\a\n");
		return;
	}
	else
	{
		if (DelNode==*START) {
			*START=(*START)->next;
			DelNode->next=NULL;
		} else {
			Previous->next=DelNode->next;
			DelNode->next=NULL;
		}
	}
	printf("NODE %d DELETED!\a\nPRESS ANY KEY TO CONTINUE...", DelNode->data);
	getchar();
	Previous=DelNode=NULL;
}

//FUNCTION THAT EMPTIES THE WHOLE LIST
void EMPTY(Node **START)
{
	Node *Current=*START, *Next;
	
	while (Current!=NULL) {
		Next = Current->next;
		free(Current);
		Current=Next;
	}
	*START = NULL;
	printf("LIST EMPTIED!\a\nPRESS ANY KEY TO CONTINUE...");
	getchar();
}

int main ()
{
	Node* START=NULL;
	int choice, value, before, after;
	char resp;

	do
	{
		printf("\n\t\t<< MENU >>\n\n");
		printf("1.\tCreate a list\n");
		printf("2.\tTraverse a list\n");
		printf("3.\tInsert a Node at the Start\n");
		printf("4.\tInsert a Node at the End\n");
		printf("5.\tInsert a Node before a Value\n");
		printf("6.\tInsert a Node after a Value\n");
		printf("7.\tDelete a Node at the Start\n");
		printf("8.\tDelete a Node at the End\n");
		printf("9.\tDelete a Node by Value\n");
		printf("10.\tEmpty Linked List\n");
		printf("11.\tEXIT\n");
		printf("\nEnter number: ");
		scanf("%d", &choice);
		getchar();
		
		switch (choice) 
		{
			case 1:
				CREATE(&START);
				break;
				
			case 2:
				TRAVERSE(START);
				break;
				
			case 3:
				printf("Enter value to be inserted at the START\n\tValue => ");
				scanf("%d", &value);
				getchar();
				INSERT_START(&START, value);
				TRAVERSE(START);
				break;
				
			case 4:
				printf("Enter value to be inserted at the END\n\tValue => ");
				scanf("%d", &value);
				getchar();
				INSERT_END(&START, value);
				TRAVERSE(START);
				break;
				
			case 5:
				printf("Enter value to be inserted\n\tValue => ");
				scanf("%d", &value);
				printf("Enter node value to be stored BEFORE it\n\tNode Value: ");
				scanf("%d", &before);
				getchar();
				INSERT_BEFORE(&START, before, value);
				TRAVERSE(START);
				break;
				
			case 6:
				printf("Enter value to be inserted\n\tValue => ");
				scanf("%d", &value);
				printf("Enter node value to be stored AFTER it\n\tNode Value: ");
				scanf("%d", &after);
				getchar();
				INSERT_AFTER(&START, after, value);
				TRAVERSE(START);
				break;
				
			case 7:
				DELETE_START(&START);
				break;
				
			case 8:
				DELETE_END(&START);
				break;
				
			case 9:
				printf("Enter value to be deleted\n\tValue => ");
				scanf("%d", &value);
				getchar();
				DELETE_VALUE(&START, value);
				TRAVERSE(START);
				break;
				
			case 10:
				EMPTY(&START);
				break;
				
			case 11:
				printf("PRESS ANY KEY TO EXIT...");
				getchar();
				return 0;
				
			default:
				printf("INVALID NUMBER!\n");
				printf("PRESS ANY KEY TO CONTINUE...");
				getchar();
				break;
		}
	} while (choice!=11);
}
